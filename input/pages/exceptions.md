After an originating system initiates an exchange, an exception could occur...

- at the destination service

  or 

- at an intermediary that is helping route the exchange.

This section describes a base set of conventions for reporting these exceptions. The *[FAST Scaling IG, not yet available]* describes exception scenarios and handling in greater depth.

<p></p>

### Approach for conveying destination and intermediary exceptions

#### Destination-reported exceptions

Exception HTTP status codes and OperationOutcomes generated by the destination are passed through unchanged by the intermediary to the originator.

<p></p>

#### Intermediary-reported exceptions

When an intermediary experiences an exception, it:

- Stops the process of routing the request 
- Returns:
  - the associated HTTP status code
  - and an OperationOutcome describing the exception situation, when possible

<p></p>

When an intermediary receives an exception reported by another intermediary, it passes the HTTP status code and OperationOutcome (if present) to the originator.

<p></p>

### Examples

<table class="grid">
  <thead>
    <tr>
      <th>Situation</th>
      <th style="min-width:150px">HTTP Status</th>
      <th>OperationOutcome</th>
      <th>Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td colspan="4"><strong><em>Exceptions reported by an intermediary</em></strong></td>
    </tr>
    <tr>
      <td><b>X-Destination canâ€™t be resolved</b> (value transmitted in either the X-Destination header parameter or X-Destination URL string)</td>
      <td>400 Bad Request</td>
      <td>OperationOutcome indicating that the supplied X-Destination cannot be resolved</td>
      <td>The originator needs to know whether the error is coming from a destination or intermediary. For debugging, auditing, it would be helpful to know which party raised the error
</td>
    </tr>
    <tr>
      <td><b>Attempt to connect to destination server timed out</b> (with no response)</td>
      <td>504 Gateway Timeout</td>
      <td>OperationOutcome indicating that the timeout occurred when trying to reach the destination server. Resource that the gateway was trying to connect to timed out</td>
        <td><i>as above</i></td>
    </tr>
    <tr>
      <td><b>System error</b></td>
      <td>500 Internal Error</td>
      <td></td>
      <td>The server may not be able to generate an OperationOutcome in a system error situation</td>
    </tr>
    <tr>
      <td colspan="4"><strong><em>Exceptions reported by the destination</em></strong></td>     
    </tr>
    <tr>
      <td><b>Submitted URL path returned Page/Resource Not Found</b></td>
      <td>404 Not Found</td>
      <td>Generated by the destination, regardless of whether using direct connect or an intermediary</td>
      <td>Intermediary passes through the status code and OperationOutcome if returned by the destination</td>
    </tr>
    <tr>
      <td><b>Invalid request</b> (e.g., bad query content)</td>
      <td>400 Bad Request</td>
      <td><i>as above</i></td>
      <td><i>as above</i></td>
    </tr>
    <tr>
      <td><b>System Error</b></td>
      <td>500 Internal Error</td>
      <td><i>as above</i></td>
      <td><i>as above</i></td>
    </tr>
  </tbody>
</table>

<p></p>

<br/>