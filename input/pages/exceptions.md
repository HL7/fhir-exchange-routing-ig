After an originating system initiates an exchange, an exception could occur...

- at the destination service

  or 

- at an intermediary that is helping route the exchange.

This section describes a base set of conventions for reporting these exceptions. 

<p></p>

### Approach for conveying destination and intermediary exceptions

#### Destination-reported exceptions

Exception HTTP status codes generated by the destination are passed through unchanged by the intermediary to the originator.

<p></p>

#### Intermediary-reported exceptions

When an intermediary experiences an exception (including no HTTP response from a downstream actor) it SHALL:

- Stop the process of routing the request 
- Return the associated [HTTP status code](https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)

  <p></p>

When an intermediary receives an exception reported by another intermediary or the destination, it SHALL pass the HTTP status code to the originator.

Note: This guide doesn't restrict parties from arranging for an intermediary to perform validation or other error detection on behalf of the destination. In that event: 
- either the intermediary or destination SHALL return an exception status code for each exception that occurs
- the intermediary MAY report errors it handles to the destination.

<p></p>

### Examples

<table class="grid">
  <thead>
    <tr>
      <th>Situation</th>
      <th style="min-width:150px">HTTP Status</th>
      <th>Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td colspan="3"><strong><em>Exceptions reported by an intermediary</em></strong></td>
    </tr>
    <tr>
      <td><b>Destination can’t be resolved</b></td>
      <td>404 Not Found</td>
      <td>Indicates that the destination could not be determined based on the submitted FHIR service base URL</td>
    </tr>
    <tr>
      <td><b>Attempt to connect to destination server timed out</b> (with no response)</td>
      <td>504 Gateway Timeout</td>
      <td>Indicates that a timeout occurred when trying to reach the destination server. Resource that the gateway was trying to connect to timed out</td>
      </tr>
    <tr>
      <td><b>System error</b></td>
      <td>500 Internal Error</td>
      <td>The server may not be able to generate an OperationOutcome in a system error situation</td>
    </tr>
    <tr>
      <td colspan="3"><strong><em>Exceptions reported by the destination</em></strong></td>     
    </tr>
    <tr>
      <td><b>Submitted URL path returned Page/Resource Not Found</b></td>
      <td>404 Not Found</td>
      <td>Generated by the destination, regardless of whether using direct connect or an intermediary. Intermediary passes through the status code and OperationOutcome if returned by the destination</td>
    </tr>
    <tr>
      <td><b>Invalid request</b> (e.g., bad query content)</td>
      <td>400 Bad Request</td>
      <td><i>as above</i></td>
    </tr>
    <tr>
      <td><b>System Error</b></td>
      <td>500 Internal Error</td>
      <td><i>as above</i></td>
    </tr>
  </tbody>
</table>


<p></p>

<br/>

